<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springmvc_mybatis.mapper.DepartmentBillMapper">
    <resultMap type="DepartmentBill" id="departmentBillResult">
        <result column="jbjgid" property="jbjgid"/>
        <result column="zdlsh" property="zdlsh"/>
        <result column="dwid" property="dwid"/>
        <result column="djzt" property="djzt"/>
        <result column="djlb" property="djlb"/>
        <result column="txr" property="txr"/>
        <result column="txsj" property="txsj"/>
        <result column="qrr" property="qrr"/>
        <result column="qrsj" property="qrsj"/>
        <result column="zje" property="zje"/>
        <result column="bz" property="bz"/>
    </resultMap>

    <select id="queryBills" resultMap="departmentBillResult">
SELECT * FROM (
SELECT A.* ,ROWNUM RN FROM
		(select * from
		si3.bill_genl
		where
		dwid =#{dwid}
		and txsj >=#{txsj}
		AND  djzt =#{djzt}) A
		WHERE ROWNUM &lt; #{next}
		) WHERE RN >=#{pre}
	</select>
    <select id="queryCount" resultType="int">
        SELECT  count(*)  FROM si3.bill_genl
         where dwid =#{dwid}
		and txsj >=#{txsj}
		AND  djzt =#{djzt}
    </select>

    <insert id="addRebackBill">

        insert into si3.bill_genl
        (zdlsh,jbjgid,dwid,djzt,djlb,txr,txsj,qrr,qrsj,zje,ryid)
        values(${zdlsh},${jbjgid},${dwid},0,'SI1002',${txr},
       SYSDATE,${qrr},SYSDATE,${zje},${ryid})
    </insert>
    <insert id="addBillDel">
        insert into si3.bill_detl
        (zdlsh,xzbz,jfxmbh,qsny,zzny,jfje) VALUES (${zdlsh},${xzbz},${jfxmbh},${qsny},${zzny},${jfje})
    </insert>
    <select id="queryZDLSH" useCache="false" flushCache="true" resultType="String">
 select si3.sq_zdlsh.nextval from dual
</select>
</mapper>