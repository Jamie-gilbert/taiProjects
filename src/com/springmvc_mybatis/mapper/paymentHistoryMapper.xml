<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springmvc_mybatis.mapper.PaymentHistoryMapper">
    <resultMap type="PaymentHistory" id="paymentHistoryResult">
        <result column="JFLSID" property="JFLSID"/>
        <result column="RYID" property="RYID"/>
        <result column="RYDJID" property="RYDJID"/>
        <result column="DWID" property="DWID"/>
        <result column="XZBZ" property="XZBZ"/>
        <result column="FSRQ" property="FSRQ"/>
        <result column="JFRQ" property="JFRQ"/>
        <result column="QSNY" property="QSNY"/>
        <result column="ZZNY" property="ZZNY"/>
        <result column="DWJFJS" property="DWJFJS"/>
        <result column="GRJFJS" property="GRJFJS"/>
        <result column="DWJFBL" property="DWJFBL"/>
        <result column="GRJFBL" property="GRJFBL"/>
        <result column="DWJFE" property="DWJFE"/>
        <result column="GRJFE" property="GRJFE"/>
        <result column="DWJFZE" property="DWJFZE"/>
        <result column="GRJFZE" property="GRJFZE"/>
        <result column="ZDLSH" property="ZDLSH"/>
        <result column="JBJGID" property="JBJGID"/>
        <result column="BZ" property="BZ"/>
        <result column="JBR" property="JBR"/>
        <result column="JBSJ" property="JBSJ"/>
        <result column="LX" property="LX"/>

        <association property="staff"
                     column="RYID"
                     select="selectStaffBystaffRYID">

        </association>
    </resultMap>
    <!--select * from #T a where ID=(select min(ID) from #T where Name=a.Name)-->
    <select id="queryBillsWithoutInterest" resultMap="paymentHistoryResult">
       SELECT * FROM (
        SELECT A.RYID,ROWNUM RN FROM
		(select * from
		si3.aged_pay_his a
		WHERE  a.DWID =${dwid} AND (a.LX=0 OR a.LX IS NULL ) AND a.JFLSID=(SELECT min(JFLSID) FROM si3.aged_pay_his WHERE RYID=a.RYID)) A
		WHERE ROWNUM &lt;= ${next}
		) WHERE RN >=${pre}
    </select>
    <select id="queryCount" resultType="int">
    SELECT COUNT (*)
    FROM si3.aged_pay_his a
		WHERE  a.DWID =${dwid} AND (a.LX=0 OR a.LX IS NULL ) AND a.JFLSID=(SELECT min(JFLSID) FROM si3.aged_pay_his WHERE RYID=a.RYID)
</select>
    <select id="selectStaffBystaffRYID" parameterType="string" resultType="Staff">
        SELECT * FROM si3.per_reg WHERE RYID=#{RYID}
    </select>
</mapper>